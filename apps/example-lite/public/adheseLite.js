var AdheseLite=function(e){"use strict";function t(e=21){let t=e,n="";const r=crypto.getRandomValues(new Uint8Array(e));for(;t--;)n+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&r[t]];return n}const n=["trace","debug","info","warn","error"];function r(e){const t=document.createElement("img");return t.src=e.toString(),t.style.height="1px",t.style.width="1px",t.style.margin="-1px",t.style.border="0",t.style.position="absolute",t.style.top="0",document.body.appendChild(t)}const o={iframe:function(e,t){const n=document.createElement("iframe");n.srcdoc=`\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <style>\n            body {\n              margin: 0;\n              padding: 0;\n              overflow: hidden;\n            }\n          </style>\n        </head>\n        <body>\n          ${String(e.tag)}\n        </body>\n      `.replaceAll(/\s+/g," ").trim(),n.style.border="none",n.style.width=e.width?`${e.width}px`:"auto",n.style.height=e.height?`${e.height}px`:"auto",t.replaceChildren(n)},inline:function(e,t){t.innerHTML=String(e.tag)}};return e.createSlot=function(e){var s;const i=function({scope:e,logLevels:r=n,minLogLevelThreshold:o=r[2]}){const s=new Set;let i=o;const a=function(){const e=new Set;return new Proxy({dispose:function(){for(const t of e)t()}},{get(t,n,r){if(!(n in t)&&"string"==typeof n){const o=function(){const e=new Set;return{listeners:e,dispatch:function(t){for(const n of e)n(t)},dispatchAsync:async function(t){await Promise.allSettled(Array.from(e).map((e=>e(t))))},addListener:function(t){e.add(t)},removeListener:function(t){e.delete(t)}}}();e.add((()=>{o.listeners.clear()})),Reflect.set(t,n,o,r)}return Reflect.get(t,n,r)}})}();return{...Object.fromEntries(r.map(((n,o)=>[n,(l,c)=>{s.add({scope:e,level:n,message:l,attributes:c,timestamp:Date.now(),id:t()}),a.log.dispatch({scope:e,level:n,message:l,attributes:c,timestamp:Date.now(),id:t()}),o>=r.indexOf(i)&&(["warn","error","trace"].includes(n)?console[n](...[`%c${e}`,"color: red; font-weight: bold;",l,c].filter(Boolean)):console.log(...[`%c${e} %c${n.toUpperCase()}`,"color: red; font-weight: bold;","font-weight: bold;",l,c].filter(Boolean)))}]))),scope:e,events:a,setMinLogLevelThreshold(e){i=e},resetMinLogLevelThreshold(){i=o},getMinLogLevelThreshold:()=>i,getLogs:()=>Array.from(s),resetLogs(){a.reset.dispatch(),s.clear()}}}({scope:"@adhese/sdk-lite@1.0.0",minLogLevelThreshold:e.debug?"debug":"info"}),a=(l=e.location,c=e.format,`${l}${(d=e.slot)?`${d}`:""}-${c}`);var l,c,d;const u=new Set,f=new IntersectionObserver((function([e]){e.isIntersecting&&(v.render().catch(i.error),null==f||f.disconnect())}),{rootMargin:"200px",threshold:0}),g=new IntersectionObserver((function([e]){const t=function(...e){return function(e,t,n){let r=e.length-t.length;if(0===r)return e(...t);if(1===r)return function(e,t,n){let r=n=>e(n,...t);return r}(e,t);throw new Error("Wrong number of arguments")}((t=Math.round,(e,n)=>{if(0===n)return t(e);if(!Number.isInteger(n))throw new TypeError(`precision must be an integer: ${n}`);if(n>15||n<-15)throw new RangeError("precision must be between -15 and 15");if(Number.isNaN(e)||!Number.isFinite(e))return t(e);let r=10**n;return t(e*r)/r}),e);var t}(e.intersectionRatio,1);t>=.2&&!L?L=setTimeout((()=>{var e,t;L=null,g.disconnect(),(null==(e=v.data)?void 0:e.viewableImpressionCounter)&&u.add(r(null==(t=v.data)?void 0:t.viewableImpressionCounter))}),1e3):t<.2&&L&&(clearTimeout(L),L=null)}),{rootMargin:"0px",threshold:Array.from({length:11},((e,t)=>.1*t))}),h="string"==typeof e.consent?{xt:e.consent}:{tl:e.consent?"all":"none"},m={...e.parameters,...h};let p=!1;const b=e.containingElement??document.createElement("div");e.containingElement||(b.id=`${a}:${t(3)}`,b.classList.add("adunit"),b.dataset.format=e.format,b.dataset.slot=e.format,b.dataset.location=e.location,null==(s=document.currentScript)||s.insertAdjacentElement("beforebegin",b));const v={options:e,name:a,logger:i,parameters:m,element:b,async request(){var t;i.debug(`Requesting ad for slot ${a}`,this);const n=await fetch(`${e.host??`https://ads-${e.account}.adhese.com`}/json`,{method:"POST",body:JSON.stringify({slots:[{slotname:a}],parameters:m}),headers:{"Content-Type":"application/json"}});if(!n.ok)throw new Error(`Failed to request ad for slot ${a}. Status: ${n.status}`);const[r]=await n.json();return this.data=r,i.debug(`Received ad data for slot ${a}`,this),null==(t=e.onRequest)||t.call(e,this),r},async render(){var t,n;const s=this.data??await this.request();if(b.removeEventListener("click",y),!s)return null==(t=e.onEmpty)||t.call(e,this),i.debug(`Slot ${a} is empty`,this),b;if("string"!=typeof s.tag)throw new Error("Received invalid ad data, tag is not a string");return o[e.renderMode??"iframe"](s,b),null==(n=e.onRender)||n.call(e,this),i.debug(`Rendered slot ${a}`,this),s.impressionCounter&&!p&&(u.add(r(s.impressionCounter)),p=!0),s.viewableImpressionCounter&&g.observe(b),b.addEventListener("click",y),b},dispose(){var t;null==(t=e.onDispose)||t.call(e,this),b.innerHTML="";for(const e of u)e.remove();u.clear(),null==f||f.disconnect(),g.disconnect(),b.removeEventListener("click",y),i.debug(`Disposing slot ${a}`,this),i.resetLogs()}};let w=!1;function y(){e.clickTrackerUrl&&!w&&(u.add(r(e.clickTrackerUrl)),w=!0)}let L=null;return f.observe(b),v},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e}({});
